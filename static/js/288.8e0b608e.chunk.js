"use strict";(self.webpackChunkwhatmorelive_react=self.webpackChunkwhatmorelive_react||[]).push([[288],{1288:function(e,t,n){n.r(t),n.d(t,{default:function(){return M}});var o=n(9543),i=n(7313),r=n(2860),s=n(499),a=n(4897),c=n(5160),d=n(9854),u=n(6967),l=n(8984),h=n(58),p=n(4669),v=n(4998),g=n(6966),m=n(6417);const f=i.lazy((()=>Promise.all([n.e(302),n.e(648),n.e(13),n.e(367),n.e(240),n.e(1),n.e(853),n.e(183),n.e(926),n.e(834),n.e(896),n.e(95)]).then(n.bind(n,3131)))),y=i.lazy((()=>Promise.all([n.e(302),n.e(648),n.e(13),n.e(367),n.e(240),n.e(1),n.e(853),n.e(183),n.e(926),n.e(834),n.e(896),n.e(634)]).then(n.bind(n,5523)))),b=i.lazy((()=>Promise.all([n.e(302),n.e(648),n.e(13),n.e(367),n.e(926),n.e(827)]).then(n.bind(n,3827)))),w=i.lazy((()=>Promise.all([n.e(302),n.e(648),n.e(13),n.e(367),n.e(926),n.e(71)]).then(n.bind(n,6071)))),T=i.lazy((()=>Promise.all([n.e(302),n.e(648),n.e(13),n.e(367),n.e(926),n.e(291)]).then(n.bind(n,1291)))),_=i.lazy((()=>Promise.all([n.e(302),n.e(580)]).then(n.bind(n,3580)))),j=i.lazy((()=>Promise.all([n.e(302),n.e(648),n.e(13),n.e(240),n.e(1),n.e(853),n.e(183),n.e(926),n.e(834),n.e(618)]).then(n.bind(n,7093)))),S=i.lazy((()=>Promise.all([n.e(302),n.e(648),n.e(13),n.e(367),n.e(240),n.e(853),n.e(926),n.e(158)]).then(n.bind(n,7158)))),x=i.lazy((()=>Promise.all([n.e(302),n.e(648),n.e(13),n.e(367),n.e(240),n.e(1),n.e(896),n.e(739)]).then(n.bind(n,8091))));var I=function(e){const[t]=(0,o.j1)("isInDesignMode"),[n]=(0,o.j1)("isDemoBrand"),[I]=(0,o.j1)("whatmoreTopBottomPadding"),[C]=(0,o.j1)("whatmoreStoriesTopBottomPadding"),{whatmoreIsStoriesTemplate:E}=(0,i.useContext)(g.I),[P]=(0,o.j1)("whatmoreShopId"),{whatmoreEventsBrowsingTemplate:O}=(0,i.useContext)(g.I),[M,k]=(0,i.useState)(-1),[V,D]=(0,i.useState)(null);var N=e.events,A=null;function G(e){(0,l.KE)()&&(0,h.QV)(),t||n||(async()=>{const t=A[e].events[0];(0,c.wh)(t),(0,p.Tc)(P,r.Xh,r.OW),(0,u.H4)(t.event_id,t.products,"homepage","stories")})(),k(A[e].start_event_index),D(e)}function Z(e){if((0,l.KE)()&&(0,h.QV)(),"video"===e.event_type)return t||n||(async()=>{(0,c.wh)(e),(0,p.Tc)(P,r.Xh,r.pR),(0,u.H4)(e.event_id,e.products,"homepage","carousel")})(),void k(e.index);var{status:o,bannerText:i,timeToStartInMins:d}=a.Z.getEventStatus(e);d<=20&&o.name!==s.Z.LIVE.name?console.debug(" TODO : show toast on upcoming live event."):k(e.index)}function U(e){return(0,m.jsx)(m.Fragment,{})}return E&&!A&&(A=function(e){var t=e.reduce(((e,t,n)=>{var o=t.storyset_id;return o in e?(e[o].total_events=e[o].total_events+1,e[o].events.push(t)):e[o]={id:t.storyset_id,title:t.storyset_name,thumbnail_image:t.storyset_thumbnail_image,total_events:1,start_event_index:n,events:[t]},e}),{}),n=Object.values(t);return n.sort(((e,t)=>e.start_event_index-t.start_event_index)),n}(N)),(0,m.jsxs)("div",{children:[(0,m.jsx)("div",{style:{marginTop:(E?C:I)+"px",marginBottom:(E?C:I)+"px"},children:"template-b"===O?(0,m.jsx)(i.Suspense,{children:(0,m.jsx)(f,{events:N,onClick:Z,heading:e.heading})}):"template-a-1"===O?(0,m.jsx)(i.Suspense,{children:(0,m.jsx)(y,{events:N,onClick:Z,heading:e.heading})}):"template-feed-a"===O?(0,m.jsx)(i.Suspense,{children:(0,m.jsx)(x,{events:N,onClick:Z,heading:e.heading})}):"template-collections-a"===O?(0,m.jsx)(i.Suspense,{children:(0,m.jsx)(b,{events:N,onClick:Z,heading:e.heading})}):"template-collections-b"===O?(0,m.jsx)(i.Suspense,{children:(0,m.jsx)(w,{events:N,onClick:Z,heading:e.heading})}):"template-collections-c"===O?(0,m.jsx)(i.Suspense,{children:(0,m.jsx)(T,{events:N,onClick:Z,heading:e.heading})}):E?(0,m.jsx)(i.Suspense,{children:(0,m.jsx)(_,{eventsStories:A,onClick:G,template:O})}):(0,m.jsx)(i.Suspense,{children:(0,m.jsx)(S,{events:N,onClick:Z,heading:e.heading})})}),-1==M?(0,m.jsx)(U,{}):(0,m.jsx)(i.Suspense,{children:(0,m.jsx)(j,{events:N,index:M,onBack:function(e){(0,d.n2)(P)&&(0,o.MO)("whatmoreAddedToCart")&&(0,v.D)(P,(()=>{}),100,window.location.hostname),k(-1)},slideDirection:E||"horizontal"===(0,d.e8)(P)?"horizontal":"vertical",eventsStories:A,initialStoryIndex:V,template:O})})]})};const C=function(e,t,n){if("undefined"!=typeof fera&&"function"===typeof fera.getRatings){var o=t.reduce(((e,t,n)=>{const o=t.products[0].client_product_id;return o in e||(e[o]=!0),e}),{}),i=Object.keys(o),r={};fera.getRatings(i,(e=>{e.forEach((e=>{r[e.external_product_id]={avgRating:e.average,totalRatings:e.count},n(r)}))}))}};n(4844),n(7247);var E=n(3933);var P=function(e){return(0,m.jsx)(m.Fragment,{children:(0,m.jsx)("div",{style:{height:"10px",width:"100%"}})})};var O=function(e){const[t,n]=(0,i.useState)(),[s,a]=(0,i.useState)(),{whatmoreIsStoriesTemplate:c}=(0,i.useContext)(g.I),{whatmoreIsCollectionsTemplate:p}=(0,i.useContext)(g.I),[v]=(0,o.j1)("whatmoreShopId"),[f]=(0,o.j1)("whatmoreCollectionId"),{ref:y,inView:b,entry:w}=(0,E.YD)({triggerOnce:!0}),[T,_]=(0,o.j1)("productRatings");var j=r.Gc+"/v1/events/",S=r.Gc+"/collection/",x=e.shopId;return(0,i.useEffect)((()=>{(0,u.hb)()}),[]),(0,i.useEffect)((()=>{null==t||0==t.length||s||!(0,l.KE)()||(0,o.MO)("whatmoreVideoPlayerPoolInitiated")||(0,h.b5)(h.UD)}),[t]),(0,i.useEffect)((()=>{var e;e=p?S.toString()+f+"?store_id="+x.toString():j.toString()+x.toString()+"?status="+"live,upcoming".toString()+"&is_active="+"true".toString()+(c?"&template_type=stories":""),fetch(e).then((e=>e.json())).then((e=>function(e,t){if(null!=e)return t?e[0].events:e}(e,p))).then((e=>function(e,t){if(null!=e)return e.filter((e=>e.products.length>0))}(e))).then((e=>(null!=e&&0!=e.length&&(0,d.LU)(v)&&function(e,t,n){const i=setInterval((()=>{null===(0,o.MO)("productRatings")&&C(e,t,n)}),3e3);setTimeout((()=>{clearInterval(i)}),1e4)}(v,e,(e=>{_(e)})),e))).then((e=>{null==e||0==e.length||c||(0,d.NO)(x,e),n(e)})).catch((e=>{a(e.message)}))}),[]),null==t||0==t.length||s?(0,m.jsx)("div",{}):(function(e,t){if(null!=e){var n=0;e.forEach((e=>{e.index=n++}))}}(t),(0,m.jsx)("div",{ref:y,children:b?(0,m.jsx)(I,{heading:e.heading,events:t}):(0,m.jsx)(P,{})},"whatmore-main-coponent"))};var M=function(e){const[t]=(0,o.j1)("isInDesignMode"),[n]=(0,o.j1)("isDemoBrand"),[s]=(0,o.j1)("whatmoreShopId"),[a]=(0,o.j1)("whatmoreHeading"),[c]=(0,o.j1)("whatmorePrimaryColor"),[d]=(0,o.j1)("whatmoreSecondaryColor");return(0,i.useEffect)((()=>{(0,p.ll)(s)}),[]),(0,m.jsx)(m.Fragment,{children:(0,m.jsx)("div",{children:t||n?(0,m.jsx)("div",{children:(0,m.jsx)(O,{heading:a,shopId:r.aA})}):(0,m.jsx)("div",{children:(0,m.jsx)(O,{heading:a,shopId:s})})})})}},499:function(e,t){t.Z={LIVE:{name:"LIVE",color:"gray.600"},UPCOMING:{name:"UPCOMING",color:"gray.600"},DEFAULT:{name:"LIVE EVENT",color:"gray.600"},COMPLETED:{name:"ENDED",color:"gray.600"}}},4897:function(e,t,n){var o=n(499);t.Z=class{static getEventStatus(e){e.time_zone="GMT+5:30";var t=e.start_time+":00",n=e.end_time,i=e.scheduled_date,r=e.status,s=e.time_zone;if(r.toUpperCase()==o.Z.LIVE.name)return{status:o.Z.LIVE,bannerText:" "+o.Z.LIVE.name+" ",timeToStartInMins:0};if(r.toUpperCase()==o.Z.UPCOMING.name){var a=new Date(i+" "+t+" "+s),c=(new Date(i+" "+n+" "+s),function(e){var t=new Date,n=(e.getTime()-t.getTime())/1e3,i=n/60,r=i/60,s=r/24;return n<=0?{status:o.Z.COMPLETED,bannerText:" "+o.Z.COMPLETED.name+" ",timeToStartInMins:0}:n>=1&&n<=30?{status:o.Z.UPCOMING,bannerText:"Starts in "+Math.round(n)+" sec ",timeToStartInMins:n/60}:i<60?{status:o.Z.UPCOMING,bannerText:"Starts in "+Math.round(i)+" min ",timeToStartInMins:i}:r<24?{status:o.Z.UPCOMING,bannerText:"Starts in "+Math.round(r)+" hr ",timeToStartInMins:60*r}:s<7?{status:o.Z.UPCOMING,bannerText:" "+["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][e.getDay()]+" ",timeToStartInMins:60*s*24}:{status:o.Z.UPCOMING,bannerText:"Upcoming",timeToStartInMins:2880}}(a));return{status:c.status,bannerText:c.bannerText,timeToStartInMins:c.timeToStartInMins}}return console.error("invalid status for event :: id : "+e.event_id+", status : "+e.status),{status:o.Z.DEFAULT,bannerText:"live event",timeToStartInMins:2880}}}},4998:function(e,t,n){n.d(t,{D:function(){return o}});const o=async function(e,t,n,o){var i=await fetch("https://"+window.location.hostname+"/cart.js",{cache:"reload"}).then((e=>e.json()));if("27358003275"==e||"63748341981"==e||"68237558034"==e)document.documentElement.dispatchEvent(new CustomEvent("cart:refresh",{bubbles:!0,detail:{cart:i,openMiniCart:!0}}));else if("19506115"==e)window.PXUTheme.jsAjaxCart.showDrawer(),window.PXUTheme.jsAjaxCart.updateView();else if("54465429691"==e)refreshCart(i),window.setTimeout((function(){$.fancybox.close(),$(".cart-button").click()}),500);else if("25427564"==e){(new theme.CartDrawer).open()}else"62602182872"==e||"57362710572"==e?(CartJS.getCart(),$(".block-cart").addClass("active")):"60492578980"==e?(document.documentElement.dispatchEvent(new CustomEvent("ajaxProduct:added",{bubbles:!0,detail:{}})),document.documentElement.dispatchEvent(new CustomEvent("cart:open",{bubbles:!0,detail:{}}))):document.documentElement.dispatchEvent(new CustomEvent("product:added",{bubbles:!0,detail:{}}));setTimeout(t,n)}},5160:function(e,t,n){n.d(t,{$L:function(){return a},JX:function(){return s},rp:function(){return c},wh:function(){return i},wz:function(){return r}});var o=n(2860);n(9543);function i(e){console.debug("updating user view count for event.");const t={event_id:e.event_id,increase_by:1};fetch(o.Gc+"/event/metrics/views",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)}).then((e=>(console.debug("updating user view count response : HTTP "+e.status),e.json()))).then((e=>{console.debug("updating user view count response : "+JSON.stringify(e))})).catch((e=>{console.error("error updating user view count user for event : ",e)}))}function r(e,t){console.debug("updating event-product click count for event {} and product {}.",e.event_id,t.product_id);const n={event_id:e.event_id,product_id:t.product_id,increase_by:1};fetch(o.Gc+"/event/metrics/clicks",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(n)}).then((e=>(console.debug("updating user event-product click count response : HTTP "+e.status),e.json()))).then((e=>{console.debug("updating user event-product click count response : "+JSON.stringify(e))})).catch((t=>{console.error("error updating user event-product click count for event {} : ",e.event_id,t)}))}function s(e,t,n){console.debug("updating event-product add to cart count for event {} and product {}.",e.event_id,t.product_id);const i={event_id:e.event_id,product_id:t.product_id,increase_by:n};fetch(o.Gc+"/event/metrics/add_to_cart",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(i)}).then((e=>(console.debug("updating user event-product add to cart count response : HTTP "+e.status),e.json()))).then((e=>{console.debug("updating user event-product add to cart count response : "+JSON.stringify(e))})).catch((t=>{console.error("error updating user event-product add to cart count for event {} : ",e.event_id,t)}))}function a(e,t){console.debug("updating event-product buy now count for event {} and product {}.",e.event_id,t.product_id);const n={event_id:e.event_id,product_id:t.product_id,increase_by:1};fetch(o.Gc+"/event/metrics/buy_now",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(n)}).then((e=>(console.debug("updating user event-product buy now count response : HTTP "+e.status),e.json()))).then((e=>{console.debug("updating user event-product buy now count response : "+JSON.stringify(e))})).catch((t=>{console.error("error updating user event-product buy now count for event {} : ",e.event_id,t)}))}async function c(){let{storeId:e="",eventId:t=0,productId:n="",variantId:i="",cartToken:r="",checkoutToken:s="",quantity:a=0,price:c="",actionType:d="",trackingId:u=""}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},l={event_id:t,product_id:n,cart_token:r,checkout_token:s,quantity:a,price:c,variant_id:i,action_type:d,tracking_id:u};console.debug("initiating ATC metadata event for eventId {}, productId {}, variantId {} ",t,n,i);const h=await fetch(o.Gc+"/cart-metadata/"+e,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(l)}).then((e=>(console.debug("initiating ATC metadata event for eventId {}, productId {}, variantId {} : HTTP "+e.status),e.json()))).catch((e=>{console.error("error initiating ATC metadata event for eventId {}, productId {}, variantId {} : ",t,n,i)}));return h}},4669:function(e,t,n){n.d(t,{Tc:function(){return u},ll:function(){return d}});var o=n(1824),i=n(9854);n(9543);const r="Whatmore Video Shopping",s="Video View",a={carousel:"Carousel",stories:"Stories",video_popup:"Video Popup"},c={homepage:"Home Page",product_page:"Product Page"};async function d(e){null!==(0,i.BH)(e)&&o.ZP.initialize((0,i.BH)(e),{useExistingGa:!0})}async function u(e,t,n){null!==(0,i.BH)(e)&&(o.ZP.event({category:r,action:s,label:c[t]+":"+a[n]}),console.debug("pushed view event to GA"))}},3933:function(e,t,n){n.d(t,{YD:function(){return l}});var o=n(7313);const i=new Map,r=new WeakMap;let s,a=0;function c(e){return Object.keys(e).sort().filter((t=>void 0!==e[t])).map((t=>{return"".concat(t,"_").concat("root"===t?(n=e.root)?(r.has(n)||(a+=1,r.set(n,a.toString())),r.get(n)):"0":e[t]);var n})).toString()}function d(e){let t=c(e),n=i.get(t);if(!n){const o=new Map;let r;const s=new IntersectionObserver((t=>{t.forEach((t=>{var n;const i=t.isIntersecting&&r.some((e=>t.intersectionRatio>=e));e.trackVisibility&&"undefined"===typeof t.isVisible&&(t.isVisible=i),null==(n=o.get(t.target))||n.forEach((e=>{e(i,t)}))}))}),e);r=s.thresholds||(Array.isArray(e.threshold)?e.threshold:[e.threshold||0]),n={id:t,observer:s,elements:o},i.set(t,n)}return n}function u(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:s;if("undefined"===typeof window.IntersectionObserver&&void 0!==o){const i=e.getBoundingClientRect();return t(o,{isIntersecting:o,target:e,intersectionRatio:"number"===typeof n.threshold?n.threshold:0,time:0,boundingClientRect:i,intersectionRect:i,rootBounds:i}),()=>{}}const{id:r,observer:a,elements:c}=d(n);let u=c.get(e)||[];return c.has(e)||c.set(e,u),u.push(t),a.observe(e),function(){u.splice(u.indexOf(t),1),0===u.length&&(c.delete(e),a.unobserve(e)),0===c.size&&(a.disconnect(),i.delete(r))}}o.Component;function l(){let{threshold:e,delay:t,trackVisibility:n,rootMargin:i,root:r,triggerOnce:s,skip:a,initialInView:c,fallbackInView:d,onChange:l}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var h;const[p,v]=o.useState(null),g=o.useRef(),[m,f]=o.useState({inView:!!c,entry:void 0});g.current=l,o.useEffect((()=>{if(a||!p)return;let o;return o=u(p,((e,t)=>{f({inView:e,entry:t}),g.current&&g.current(e,t),t.isIntersecting&&s&&o&&(o(),o=void 0)}),{root:r,rootMargin:i,threshold:e,trackVisibility:n,delay:t},d),()=>{o&&o()}}),[Array.isArray(e)?e.toString():e,p,r,i,s,a,n,d,t]);const y=null==(h=m.entry)?void 0:h.target;o.useEffect((()=>{p||!y||s||a||f({inView:!!c,entry:void 0})}),[p,y,s,a,c]);const b=[v,m.inView,m.entry];return b.ref=b[0],b.inView=b[1],b.entry=b[2],b}}}]);