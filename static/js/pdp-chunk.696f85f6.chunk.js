"use strict";(self.webpackChunkwhatmorelive_react=self.webpackChunkwhatmorelive_react||[]).push([[5431],{14284:function(e,t,n){n.r(t);var o=n(47313),i=n(49854),r=n(32860),a=n(99543),c=n(75160),s=n(26967),d=n(75380),l=n(60058),u=n(68984),h=n(24669),p=n(30941),v=n(86173),w=n(16826),f=n(7300),g=n(86524),E=n(30364),m=n(47376),S=n(50778),_=n(17643),j=n(27008),y=n(7381),I=n(46417);const b=(0,w.Z)({key:"whatmore-css-ppv"}),P=o.lazy((()=>Promise.all([n.e(2131),n.e(2739),n.e(8502),n.e(3583),n.e(2703),n.e(7450),n.e(6949),n.e(229),n.e(6981),n.e(8932),n.e(2374),n.e(839),n.e(6333),n.e(9755),n.e(9356),n.e(2013),n.e(8394),n.e(4901),n.e(133),n.e(1521),n.e(3669),n.e(9969),n.e(9484),n.e(7268),n.e(1142),n.e(6525),n.e(1856),n.e(7357),n.e(8604),n.e(6848),n.e(971),n.e(5356),n.e(4981),n.e(3853),n.e(5113),n.e(1537),n.e(7359),n.e(2688),n.e(79),n.e(670),n.e(9824),n.e(8013),n.e(8342),n.e(3046),n.e(1655),n.e(8817),n.e(3398),n.e(3596),n.e(1343),n.e(8080),n.e(352),n.e(4814),n.e(7187),n.e(1929),n.e(3930),n.e(1915),n.e(3615),n.e(1752),n.e(1983),n.e(824),n.e(9001),n.e(9164),n.e(1446),n.e(1478),n.e(731),n.e(4404),n.e(4958),n.e(5504),n.e(1942),n.e(6978),n.e(8012),n.e(245)]).then(n.bind(n,8933))));function x(e){return e.split(/[?#]/)[0]}t.default=function(e){const[t,n]=(0,o.useState)(),[w,k]=(0,o.useState)(),[T]=(0,a.j1)("isInDesignMode"),[L]=(0,a.j1)("isDemoBrand"),[D]=(0,a.j1)("whatmoreEmbedAppUseVariant"),[O,V]=(0,o.useState)(-2),[C]=(0,a.j1)("whatmoreVariantId"),[K]=(0,a.j1)("whatmoreShopId");var[M]=(0,a.j1)("whatmoreProductId");const W=(0,a.MO)("isLandingSharedLink"),U=(0,a.MO)("whatmoreShareTemplateId"),A=(0,a.MO)("whatmoreShareEventId");M=(0,i.iXA)(K)?x(window.location.href):M;const[B,F]=(0,o.useState)((()=>"true"===D?C:M));var G=r.Gc+"/v2/brand/"+K+"/product-events";const{whatmoreWidgetSourceDetails:J}=(0,o.useContext)(E.I);(0,o.useEffect)((()=>{(0,y.Oo)("Video shopping powered by Whatmore!"),(0,s.hb)();const e=()=>{const e="_whatmore_bulk_events",t=JSON.parse(localStorage.getItem(e))||[];t&&t.length>0&&((0,j.K)(t),localStorage.removeItem(e))};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}}),[]),(0,o.useEffect)((()=>{(0,h.ll)(K)}),[]),(0,o.useEffect)((()=>{null==t||0==t.length||w||!(0,u.KE)()||(0,a.MO)("whatmoreVideoPlayerPoolInitiated")||(0,l.b5)(l.UD)}),[t]),(0,o.useEffect)((()=>{V(-1),fetch(G.toString()+"?client_product_id="+B.toString()+"&status="+"upcoming".toString()+"&event_type=video").then((e=>e.json())).then((e=>e.events)).then((e=>(n(e),e))).then((e=>((0,i.yoE)(K)&&function(e,t){setTimeout((async()=>{const n=e.reduce(((e,t)=>[...e,...t.products]),[]).filter((e=>e.client_product_id==t))[0];if(!n||n.product_link==x(window.location.href))return;const o={product_id:n.product_id,product_link:x(window.location.href)};fetch(r.Gc+"/product",{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(o)})}),500)}(e,B),e))).catch((e=>{k(e.message)}))}),[B]),(0,o.useEffect)((()=>{var e,n;V(-2),(t&&t.length>0||(0,i.uO6)(K))&&(0,m.PB)({userInteractionType:S.K.PDP_VISITED,widgetSourceDetails:J,event:null===t||void 0===t?void 0:t[0],productList:null===t||void 0===t||null===(e=t[0])||void 0===e?void 0:e.products,ctaList:null===t||void 0===t||null===(n=t[0])||void 0===n?void 0:n.cta})}),[t]),(0,o.useEffect)((()=>{let e=history.pushState;history.pushState=function(){let t=e.apply(this,arguments);return window.dispatchEvent(new Event("pushstate")),window.dispatchEvent(new Event("locationchange")),t};let t=history.replaceState;history.replaceState=function(){let e=t.apply(this,arguments);return window.dispatchEvent(new Event("replacestate")),window.dispatchEvent(new Event("locationchange")),e},window.addEventListener("popstate",(()=>{window.dispatchEvent(new Event("locationchange"))})),window.addEventListener("locationchange",(function(){if("true"===D){const e=function(e){for(var t=window.location.search.substring(1).split("&"),n=0;n<t.length;n++){var o=t[n].split("=");if(o[0]==e)return o[1]}return!1}("variant");e&&""!==e&&F(e)}}))}),[]),(0,o.useEffect)((()=>{null==t||0==t.length||w||W&&"template-embed"==(0,g.zv)(U)&&null!=A&&t.forEach(((e,t)=>{A==e.event_id&&N(e,!0,t)}))}),[t]);const N=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if((0,u.KE)()&&!t&&(0,l.QV)(),(0,f.B6)(e)||(0,f.WJ)(e))return T||L||(async()=>{(0,c.wh)(e),(0,h.Tc)(K,r.h7,r.dU),(0,s.H4)(e.event_id,e.products,"product_page","video_popup")})(),void V(n)};function z(){return(0,I.jsx)(I.Fragment,{})}return null==t||0==t.length||w?(0,I.jsx)("div",{}):(0,I.jsx)(v.C,{value:b,children:"no-product"===B||-1===O||0===t.length?(0,I.jsx)(z,{}):-2===O&&t.length>0?(0,I.jsx)("div",{children:(0,I.jsx)(_.u,{userInteractionType:S.K.PDP_POPUP_WIDGET_VIEW,event:t[0],productList:t[0].products,cta:t[0].cta,triggerFlag:!T&&!L,children:(0,I.jsx)(d.Z,{event:t[0],inVideoClick:N,closeClick:e=>{e.stopPropagation(),V(-1)}})})}):(0,I.jsx)("div",{children:(0,I.jsx)(o.Suspense,{children:(0,I.jsx)(_.u,{userInteractionType:S.K.EVENT_VIEW,event:t[0],productList:t[0].products,cta:t[0].cta,triggerFlag:!T&&!L,children:(0,I.jsx)(P,{events:t,index:O,onBack:function(){(0,i.n2L)(K)&&(0,a.MO)("whatmoreAddedToCart")&&(0,p.D)(K,(()=>{}),100,window.location.hostname),V(-2)},template:"template-product-page"})})})})})}}}]);