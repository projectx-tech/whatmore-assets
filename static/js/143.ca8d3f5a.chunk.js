"use strict";(self.webpackChunkwhatmorelive_react=self.webpackChunkwhatmorelive_react||[]).push([[143],{4284:function(t,e,n){n.r(e);var o=n(7313),i=n(9854),r=n(2860),a=n(7753),c=n(5160),s=n(6967),d=n(5380),u=n(58),l=n(8984),p=n(4669),v=n(513),h=n(9302),w=n(2575),_=n(7300),f=n(6524),E=n(8811),g=n(4522),I=n(778),m=n(7643),L=n(7008),S=n(7381),T=n(6417);const y=(0,w.Z)({key:"whatmore-css-ppv"}),D=o.lazy((()=>Promise.all([n.e(819),n.e(577),n.e(351),n.e(955),n.e(926),n.e(303),n.e(218),n.e(903)]).then(n.bind(n,3218))));function C(t){return t.split(/[?#]/)[0]}e.default=function(t){const[e,n]=(0,o.useState)(),[w,K]=(0,o.useState)(),[O]=(0,a.j1)("isInDesignMode"),[j]=(0,a.j1)("isDemoBrand"),[P]=(0,a.j1)("whatmoreEmbedAppUseVariant"),[V,b]=(0,o.useState)(-2),[k]=(0,a.j1)("whatmoreVariantId"),[M]=(0,a.j1)("whatmoreShopId");var[x]=(0,a.j1)("whatmoreProductId");const A=(0,a.MO)("isLandingSharedLink"),W=(0,a.MO)("whatmoreShareTemplateId"),U=(0,a.MO)("whatmoreShareEventId");x=(0,i.iXA)(M)?C(window.location.href):x;const[N,B]=(0,o.useState)((()=>"true"===P?k:x));var H=r.Gc+"/v2/brand/"+M+"/product-events";const{whatmoreWidgetSourceDetails:F}=(0,o.useContext)(E.I);(0,o.useEffect)((()=>{(0,S.Oo)("Video shopping powered by Whatmore!"),(0,s.hb)();const t=()=>{const t="_whatmore_bulk_events",e=JSON.parse(localStorage.getItem(t))||[];e&&e.length>0&&((0,L.K)(e),localStorage.removeItem(t))};return window.addEventListener("beforeunload",t),()=>{window.removeEventListener("beforeunload",t)}}),[]),(0,o.useEffect)((()=>{(0,p.ll)(M)}),[]),(0,o.useEffect)((()=>{null==e||0==e.length||w||!(0,l.KE)()||(0,a.MO)("whatmoreVideoPlayerPoolInitiated")||(0,u.b5)(u.UD)}),[e]),(0,o.useEffect)((()=>{b(-1),fetch(H.toString()+"?client_product_id="+N.toString()+"&status="+"upcoming".toString()+"&event_type=video").then((t=>t.json())).then((t=>t.events)).then((t=>(null!=t&&0!=t.length&&(0,i.Htz)(M)&&(0,i.d0x)(t),n(t),t))).then((t=>((0,i.yoE)(M)&&function(t,e){setTimeout((async()=>{const n=t.reduce(((t,e)=>[...t,...e.products]),[]).filter((t=>t.client_product_id==e))[0];if(!n||n.product_link==C(window.location.href))return;const o={product_id:n.product_id,product_link:C(window.location.href)};fetch(r.Gc+"/product",{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(o)})}),500)}(t,N),t))).catch((t=>{K(t.message)}))}),[N]),(0,o.useEffect)((()=>{var t,n;b(-2),(e&&e.length>0||(0,i.uO6)(M))&&(0,g.PB)({userInteractionType:I.K.PDP_VISITED,widgetSourceDetails:F,event:null===e||void 0===e?void 0:e[0],productList:null===e||void 0===e||null===(t=e[0])||void 0===t?void 0:t.products,ctaList:null===e||void 0===e||null===(n=e[0])||void 0===n?void 0:n.cta})}),[e]),(0,o.useEffect)((()=>{let t=history.pushState;history.pushState=function(){let e=t.apply(this,arguments);return window.dispatchEvent(new Event("pushstate")),window.dispatchEvent(new Event("locationchange")),e};let e=history.replaceState;history.replaceState=function(){let t=e.apply(this,arguments);return window.dispatchEvent(new Event("replacestate")),window.dispatchEvent(new Event("locationchange")),t},window.addEventListener("popstate",(()=>{window.dispatchEvent(new Event("locationchange"))})),window.addEventListener("locationchange",(function(){if("true"===P){const t=function(t){for(var e=window.location.search.substring(1).split("&"),n=0;n<e.length;n++){var o=e[n].split("=");if(o[0]==t)return o[1]}return!1}("variant");t&&""!==t&&B(t)}}))}),[]),(0,o.useEffect)((()=>{null==e||0==e.length||w||A&&"template-embed"==(0,f.zv)(W)&&null!=U&&e.forEach(((t,e)=>{U==t.event_id&&z(t,!0,e)}))}),[e]);const G=F.landingLocationType,R=F.templateType,z=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if((0,l.KE)()&&!e&&(0,u.QV)(),(0,_.B6)(t)||(0,_.WJ)(t))return O||j||(async()=>{const e=(0,f.NY)(G)+(0,f.dS)(R)+"_"+(null===t||void 0===t?void 0:t.event_id);(0,c.wh)(t),(0,p.Tc)(M,r.h7,r.dU),(0,s.H4)(t.event_id,t.products,"product_page","video_popup",e)})(),void b(n)};function J(){return(0,T.jsx)(T.Fragment,{})}return null==e||0==e.length||w?(0,T.jsx)("div",{}):(0,T.jsx)(h.C,{value:y,children:"no-product"===N||-1===V||0===e.length?(0,T.jsx)(J,{}):-2===V&&e.length>0?(0,T.jsx)("div",{children:(0,T.jsx)(m.u,{userInteractionType:I.K.PDP_POPUP_WIDGET_VIEW,event:e[0],productList:e[0].products,cta:e[0].cta,triggerFlag:!O&&!j,children:(0,T.jsx)(d.Z,{event:e[0],inVideoClick:z,closeClick:t=>{t.stopPropagation(),b(-1)}})})}):(0,T.jsx)("div",{children:(0,T.jsx)(o.Suspense,{children:(0,T.jsx)(m.u,{userInteractionType:I.K.EVENT_VIEW,event:e[0],productList:e[0].products,cta:e[0].cta,triggerFlag:!O&&!j,children:(0,T.jsx)(D,{events:e,index:V,onBack:function(t){(0,i.n2L)(M)&&(0,a.MO)("whatmoreAddedToCart")&&(0,v.D)(M,(()=>{}),100,window.location.hostname,t),b(-2)},template:"template-product-page"})})})})})}},4522:function(t,e,n){n.d(e,{gW:function(){return c},GF:function(){return s},y4:function(){return u},PB:function(){return l},Z2:function(){return d}});var o=n(9854),i=n(7753),r=n(778);var a=n(733);const c={[r.K.EVENT_VIEW]:"whatmore_video_click_event",[r.K.VIDEO_LIKED]:"whatmore_video_like_event",[r.K.VIDEO_SHARE_CTA_CLICKED]:"whatmore_video_share_event",[r.K.PRODUCT_TILE_ATC_CLICKED]:"whatmore_video_atc_event",[r.K.SHOPNOW_ATC_CLICKED]:"whatmore_video_atc_event"};function s(t){var e;let{userInteractionType:n,userInteractionMetadata:s,widgetSourceDetails:d,event:u,productList:l,ctaList:p}=t;(0,a.s)({userInteractionType:n,userInteractionMetadata:s,widgetSourceDetails:d,event:u,productList:l,ctaList:p}),n in c&&function(t,e){const n=(0,i.MO)("whatmoreShopId");(t!=r.K.EVENT_VIEW||(0,o.UAB)(n))&&(t!=r.K.SHOPNOW_ATC_CLICKED&&t!=r.K.PRODUCT_TILE_ATC_CLICKED||(0,o.Tn_)(n))&&(t!=r.K.VIDEO_LIKED||(0,o.sKB)(n))&&(t!=r.K.VIDEO_SHARE_CTA_CLICKED||(0,o.YOU)(n))&&"function"==typeof fbq&&(async()=>{console.log("hello"),fbq("trackCustom",c[t],{id:null===e||void 0===e?void 0:e.client_product_id,product_url:null===e||void 0===e?void 0:e.product_link})})()}(n,null!==(e=null===l||void 0===l?void 0:l[1])&&void 0!==e?e:null===l||void 0===l?void 0:l[0])}function d(t){let{userInteractionType:e,userInteractionMetadata:n,widgetSourceDetails:o,event:i,productList:r,ctaList:c}=t;(0,a.s)({userInteractionType:e,userInteractionMetadata:n,widgetSourceDetails:o,event:i,productList:r,ctaList:c})}function u(t){let{userInteractionType:e,userInteractionMetadata:n,widgetSourceDetails:o,event:i,productList:r,ctaList:c}=t;(0,a.s)({userInteractionType:e,userInteractionMetadata:n,widgetSourceDetails:o,event:i,productList:r,ctaList:c})}function l(t){let{userInteractionType:e,userInteractionMetadata:n,widgetSourceDetails:o,event:i,productList:r,ctaList:c}=t;(0,a.s)({userInteractionType:e,userInteractionMetadata:n,widgetSourceDetails:o,event:i,productList:r,ctaList:c})}}}]);