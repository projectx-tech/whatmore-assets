"use strict";(self.webpackChunkwhatmorelive_react=self.webpackChunkwhatmorelive_react||[]).push([[143],{4284:function(t,e,n){n.r(e);var o=n(7313),i=n(9854),r=n(2860),a=n(7753),c=n(5160),s=n(6967),u=n(5380),d=n(58),l=n(8984),p=n(4669),h=n(513),v=n(9302),w=n(2575),f=n(7300),g=n(6524),I=n(8811),m=n(7376),E=n(778),S=n(7643),y=n(7008),L=n(7381),_=n(6417);const T=(0,w.Z)({key:"whatmore-css-ppv"}),j=o.lazy((()=>Promise.all([n.e(819),n.e(577),n.e(351),n.e(955),n.e(926),n.e(303),n.e(218),n.e(903)]).then(n.bind(n,3218))));function D(t){return t.split(/[?#]/)[0]}e.default=function(t){const[e,n]=(0,o.useState)(),[w,P]=(0,o.useState)(),[b]=(0,a.j1)("isInDesignMode"),[x]=(0,a.j1)("isDemoBrand"),[M]=(0,a.j1)("whatmoreEmbedAppUseVariant"),[k,O]=(0,o.useState)(-2),[V]=(0,a.j1)("whatmoreVariantId"),[C]=(0,a.j1)("whatmoreShopId");var[K]=(0,a.j1)("whatmoreProductId");const W=(0,a.MO)("isLandingSharedLink"),B=(0,a.MO)("whatmoreShareTemplateId"),U=(0,a.MO)("whatmoreShareEventId");K=(0,i.iXA)(C)?D(window.location.href):K;const[A,F]=(0,o.useState)((()=>"true"===M?V:K));var G=r.Gc+"/v2/brand/"+C+"/product-events";const{whatmoreWidgetSourceDetails:N}=(0,o.useContext)(I.I);(0,o.useEffect)((()=>{(0,L.Oo)("Video shopping powered by Whatmore!"),(0,s.hb)();const t=()=>{const t="_whatmore_bulk_events",e=JSON.parse(localStorage.getItem(t))||[];e&&e.length>0&&((0,y.K)(e),localStorage.removeItem(t))};return window.addEventListener("beforeunload",t),()=>{window.removeEventListener("beforeunload",t)}}),[]),(0,o.useEffect)((()=>{(0,p.ll)(C)}),[]),(0,o.useEffect)((()=>{null==e||0==e.length||w||!(0,l.KE)()||(0,a.MO)("whatmoreVideoPlayerPoolInitiated")||(0,d.b5)(d.UD)}),[e]),(0,o.useEffect)((()=>{O(-1),fetch(G.toString()+"?client_product_id="+A.toString()+"&status="+"upcoming".toString()+"&event_type=video").then((t=>t.json())).then((t=>t.events)).then((t=>(null!=t&&0!=t.length&&(0,i.Htz)(C)&&(0,i.d0x)(t),n(t),t))).then((t=>((0,i.yoE)(C)&&function(t,e){setTimeout((async()=>{const n=t.reduce(((t,e)=>[...t,...e.products]),[]).filter((t=>t.client_product_id==e))[0];if(!n||n.product_link==D(window.location.href))return;const o={product_id:n.product_id,product_link:D(window.location.href)};fetch(r.Gc+"/product",{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(o)})}),500)}(t,A),t))).catch((t=>{P(t.message)}))}),[A]),(0,o.useEffect)((()=>{var t,n;O(-2),(e&&e.length>0||(0,i.uO6)(C))&&(0,m.PB)({userInteractionType:E.K.PDP_VISITED,widgetSourceDetails:N,event:null===e||void 0===e?void 0:e[0],productList:null===e||void 0===e||null===(t=e[0])||void 0===t?void 0:t.products,ctaList:null===e||void 0===e||null===(n=e[0])||void 0===n?void 0:n.cta})}),[e]),(0,o.useEffect)((()=>{let t=history.pushState;history.pushState=function(){let e=t.apply(this,arguments);return window.dispatchEvent(new Event("pushstate")),window.dispatchEvent(new Event("locationchange")),e};let e=history.replaceState;history.replaceState=function(){let t=e.apply(this,arguments);return window.dispatchEvent(new Event("replacestate")),window.dispatchEvent(new Event("locationchange")),t},window.addEventListener("popstate",(()=>{window.dispatchEvent(new Event("locationchange"))})),window.addEventListener("locationchange",(function(){if("true"===M){const t=function(t){for(var e=window.location.search.substring(1).split("&"),n=0;n<e.length;n++){var o=e[n].split("=");if(o[0]==t)return o[1]}return!1}("variant");t&&""!==t&&F(t)}}))}),[]),(0,o.useEffect)((()=>{null==e||0==e.length||w||W&&"template-embed"==(0,g.zv)(B)&&null!=U&&e.forEach(((t,e)=>{U==t.event_id&&Z(t,!0,e)}))}),[e]);const z=N.landingLocationType,J=N.templateType,Z=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if((0,l.KE)()&&!e&&(0,d.QV)(),(0,f.B6)(t)||(0,f.WJ)(t))return b||x||(async()=>{const e=(0,g.NY)(z)+(0,g.dS)(J)+"_"+(null===t||void 0===t?void 0:t.event_id);(0,c.wh)(t),(0,p.Tc)(C,r.h7,r.dU),(0,s.H4)(t.event_id,t.products,"product_page","video_popup",e)})(),void O(n)};function H(){return(0,_.jsx)(_.Fragment,{})}return null==e||0==e.length||w?(0,_.jsx)("div",{}):(0,_.jsx)(v.C,{value:T,children:"no-product"===A||-1===k||0===e.length?(0,_.jsx)(H,{}):-2===k&&e.length>0?(0,_.jsx)("div",{children:(0,_.jsx)(S.u,{userInteractionType:E.K.PDP_POPUP_WIDGET_VIEW,event:e[0],productList:e[0].products,cta:e[0].cta,triggerFlag:!b&&!x,children:(0,_.jsx)(u.Z,{event:e[0],inVideoClick:Z,closeClick:t=>{t.stopPropagation(),O(-1)}})})}):(0,_.jsx)("div",{children:(0,_.jsx)(o.Suspense,{children:(0,_.jsx)(S.u,{userInteractionType:E.K.EVENT_VIEW,event:e[0],productList:e[0].products,cta:e[0].cta,triggerFlag:!b&&!x,children:(0,_.jsx)(j,{events:e,index:k,onBack:function(t){(0,i.n2L)(C)&&(0,a.MO)("whatmoreAddedToCart")&&(0,h.D)(C,(()=>{}),100,window.location.hostname,t),O(-2)},template:"template-product-page"})})})})})}},7376:function(t,e,n){n.d(e,{GF:function(){return i},PB:function(){return c},Z2:function(){return r},y4:function(){return a}});var o=n(733);function i(t){let{userInteractionType:e,userInteractionMetadata:n,widgetSourceDetails:i,event:r,productList:a,ctaList:c}=t;(0,o.s)({userInteractionType:e,userInteractionMetadata:n,widgetSourceDetails:i,event:r,productList:a,ctaList:c})}function r(t){let{userInteractionType:e,userInteractionMetadata:n,widgetSourceDetails:i,event:r,productList:a,ctaList:c}=t;(0,o.s)({userInteractionType:e,userInteractionMetadata:n,widgetSourceDetails:i,event:r,productList:a,ctaList:c})}function a(t){let{userInteractionType:e,userInteractionMetadata:n,widgetSourceDetails:i,event:r,productList:a,ctaList:c}=t;(0,o.s)({userInteractionType:e,userInteractionMetadata:n,widgetSourceDetails:i,event:r,productList:a,ctaList:c})}function c(t){let{userInteractionType:e,userInteractionMetadata:n,widgetSourceDetails:i,event:r,productList:a,ctaList:c}=t;(0,o.s)({userInteractionType:e,userInteractionMetadata:n,widgetSourceDetails:i,event:r,productList:a,ctaList:c})}}}]);