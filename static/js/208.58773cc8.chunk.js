"use strict";(self.webpackChunkwhatmorelive_react=self.webpackChunkwhatmorelive_react||[]).push([[208],{7208:function(e,t,n){n.r(t),n.d(t,{default:function(){return E}});var o=n(9543),i=n(7313),a=n(2860),r=n(499),s=n(4897),c=n(5160),d=n(9854),u=n(6967),l=n(8984),p=n(58),h=n(4669),v=n(4998),g=n(6966),m=n(6417);const f=i.lazy((()=>Promise.all([n.e(648),n.e(13),n.e(367),n.e(240),n.e(1),n.e(853),n.e(183),n.e(926),n.e(462),n.e(787),n.e(400),n.e(95)]).then(n.bind(n,3131)))),T=i.lazy((()=>Promise.all([n.e(648),n.e(13),n.e(367),n.e(240),n.e(1),n.e(853),n.e(183),n.e(926),n.e(462),n.e(787),n.e(400),n.e(634)]).then(n.bind(n,5523)))),y=i.lazy((()=>Promise.all([n.e(648),n.e(13),n.e(367),n.e(926),n.e(262),n.e(576)]).then(n.bind(n,3827)))),_=i.lazy((()=>Promise.all([n.e(648),n.e(13),n.e(367),n.e(926),n.e(262),n.e(916)]).then(n.bind(n,6071)))),b=i.lazy((()=>Promise.all([n.e(648),n.e(13),n.e(367),n.e(926),n.e(262),n.e(491)]).then(n.bind(n,1291)))),j=i.lazy((()=>n.e(580).then(n.bind(n,3580)))),S=i.lazy((()=>Promise.all([n.e(648),n.e(13),n.e(240),n.e(1),n.e(853),n.e(183),n.e(926),n.e(462),n.e(618)]).then(n.bind(n,3754)))),x=i.lazy((()=>Promise.all([n.e(648),n.e(13),n.e(367),n.e(240),n.e(853),n.e(926),n.e(158)]).then(n.bind(n,7158)))),I=i.lazy((()=>Promise.all([n.e(648),n.e(13),n.e(367),n.e(240),n.e(1),n.e(262),n.e(787),n.e(887)]).then(n.bind(n,8091))));var w=function(e){const[t]=(0,o.j1)("isInDesignMode"),[n]=(0,o.j1)("isDemoBrand"),[w]=(0,o.j1)("whatmoreTopBottomPadding"),[C]=(0,o.j1)("whatmoreStoriesTopBottomPadding"),{whatmoreIsStoriesTemplate:P}=(0,i.useContext)(g.I),[E]=(0,o.j1)("whatmoreShopId"),{whatmoreEventsBrowsingTemplate:O}=(0,i.useContext)(g.I),[M,k]=(0,i.useState)(-1),[D,N]=(0,i.useState)(null);var G=e.events,Z=null;function U(e){(0,l.KE)()&&(0,p.QV)(),t||n||(async()=>{const t=Z[e].events[0];(0,c.wh)(t),(0,h.Tc)(E,a.Xh,a.OW),(0,u.H4)(t.event_id,t.products,"homepage","stories")})(),k(Z[e].start_event_index),N(e)}function V(e){if((0,l.KE)()&&(0,p.QV)(),"video"===e.event_type)return t||n||(async()=>{(0,c.wh)(e),(0,h.Tc)(E,a.Xh,a.pR),(0,u.H4)(e.event_id,e.products,"homepage","carousel")})(),void k(e.index);var{status:o,bannerText:i,timeToStartInMins:d}=s.Z.getEventStatus(e);d<=20&&o.name!==r.Z.LIVE.name?console.debug(" TODO : show toast on upcoming live event."):k(e.index)}function z(e){return(0,m.jsx)(m.Fragment,{})}return P&&!Z&&(Z=function(e){var t=e.reduce(((e,t,n)=>{var o=t.storyset_id;return o in e?(e[o].total_events=e[o].total_events+1,e[o].events.push(t)):e[o]={id:t.storyset_id,title:t.storyset_name,thumbnail_image:t.storyset_thumbnail_image,total_events:1,start_event_index:n,events:[t]},e}),{}),n=Object.values(t);return n.sort(((e,t)=>e.start_event_index-t.start_event_index)),n}(G)),(0,m.jsxs)("div",{children:[(0,m.jsx)("div",{style:{marginTop:(P?C:w)+"px",marginBottom:(P?C:w)+"px"},children:"template-b"===O?(0,m.jsx)(i.Suspense,{children:(0,m.jsx)(f,{events:G,onClick:V,heading:e.heading})}):"template-a-1"===O?(0,m.jsx)(i.Suspense,{children:(0,m.jsx)(T,{events:G,onClick:V,heading:e.heading})}):"template-feed-a"===O?(0,m.jsx)(i.Suspense,{children:(0,m.jsx)(I,{events:G,onClick:V,heading:e.heading})}):"template-collections-a"===O?(0,m.jsx)(i.Suspense,{children:(0,m.jsx)(y,{events:G,onClick:V,heading:e.heading})}):"template-collections-b"===O?(0,m.jsx)(i.Suspense,{children:(0,m.jsx)(_,{events:G,onClick:V,heading:e.heading})}):"template-collections-c"===O?(0,m.jsx)(i.Suspense,{children:(0,m.jsx)(b,{events:G,onClick:V,heading:e.heading})}):P?(0,m.jsx)(i.Suspense,{children:(0,m.jsx)(j,{eventsStories:Z,onClick:U,template:O})}):(0,m.jsx)(i.Suspense,{children:(0,m.jsx)(x,{events:G,onClick:V,heading:e.heading})})}),-1==M?(0,m.jsx)(z,{}):(0,m.jsx)(i.Suspense,{children:(0,m.jsx)(S,{events:G,index:M,onBack:function(e){(0,d.n2)(E)&&(0,o.MO)("whatmoreAddedToCart")&&(0,v.D)(E,(()=>{}),100,window.location.hostname),k(-1)},slideDirection:P||"horizontal"===(0,d.e8)(E)?"horizontal":"vertical",eventsStories:Z,initialStoryIndex:D,template:O})})]})};const C=function(e,t,n){if("undefined"!=typeof fera&&"function"===typeof fera.getRatings){var o=t.reduce(((e,t,n)=>{const o=t.products[0].client_product_id;return o in e||(e[o]=!0),e}),{}),i=Object.keys(o),a={};fera.getRatings(i,(e=>{e.forEach((e=>{a[e.external_product_id]={avgRating:e.average,totalRatings:e.count},n(a)}))}))}};n(4844),n(7247);var P=function(e){const[t,n]=(0,i.useState)(),[r,s]=(0,i.useState)(),{whatmoreIsStoriesTemplate:c}=(0,i.useContext)(g.I),{whatmoreIsCollectionsTemplate:h}=(0,i.useContext)(g.I),[v]=(0,o.j1)("whatmoreShopId"),[f]=(0,o.j1)("whatmoreCollectionId"),[T,y]=(0,o.j1)("productRatings");var _=a.Gc+"/v1/events/",b=a.Gc+"/collection/",j=e.shopId;return(0,i.useEffect)((()=>{(0,u.hb)()}),[]),(0,i.useEffect)((()=>{null==t||0==t.length||r||!(0,l.KE)()||(0,o.MO)("whatmoreVideoPlayerPoolInitiated")||(0,p.b5)(p.UD)}),[t]),(0,i.useEffect)((()=>{var e;e=h?b.toString()+f+"?store_id="+j.toString():_.toString()+j.toString()+"?status="+"live,upcoming".toString()+"&is_active="+"true".toString()+(c?"&template_type=stories":""),fetch(e).then((e=>e.json())).then((e=>function(e,t){if(null!=e)return t?e[0].events:e}(e,h))).then((e=>function(e,t){if(null!=e)return e.filter((e=>e.products.length>0))}(e))).then((e=>(null!=e&&0!=e.length&&(0,d.LU)(v)&&function(e,t,n){const i=setInterval((()=>{null===(0,o.MO)("productRatings")&&C(e,t,n)}),3e3);setTimeout((()=>{clearInterval(i)}),1e4)}(v,e,(e=>{y(e)})),e))).then((e=>{null==e||0==e.length||c||(0,d.NO)(j,e),n(e)})).catch((e=>{s(e.message)}))}),[]),null==t||0==t.length||r?(0,m.jsx)("div",{}):(function(e,t){if(null!=e){var n=0;e.forEach((e=>{e.index=n++}))}}(t),(0,m.jsx)(w,{heading:e.heading,events:t}))};var E=function(e){const[t]=(0,o.j1)("isInDesignMode"),[n]=(0,o.j1)("isDemoBrand"),[r]=(0,o.j1)("whatmoreShopId"),[s]=(0,o.j1)("whatmoreHeading"),[c]=(0,o.j1)("whatmorePrimaryColor"),[d]=(0,o.j1)("whatmoreSecondaryColor");return(0,i.useEffect)((()=>{(0,h.ll)(r)}),[]),(0,m.jsx)(m.Fragment,{children:(0,m.jsx)("div",{children:t||n?(0,m.jsx)("div",{children:(0,m.jsx)(P,{heading:s,shopId:a.aA})}):(0,m.jsx)("div",{children:(0,m.jsx)(P,{heading:s,shopId:r})})})})}},499:function(e,t){t.Z={LIVE:{name:"LIVE",color:"gray.600"},UPCOMING:{name:"UPCOMING",color:"gray.600"},DEFAULT:{name:"LIVE EVENT",color:"gray.600"},COMPLETED:{name:"ENDED",color:"gray.600"}}},4897:function(e,t,n){var o=n(499);t.Z=class{static getEventStatus(e){e.time_zone="GMT+5:30";var t=e.start_time+":00",n=e.end_time,i=e.scheduled_date,a=e.status,r=e.time_zone;if(a.toUpperCase()==o.Z.LIVE.name)return{status:o.Z.LIVE,bannerText:" "+o.Z.LIVE.name+" ",timeToStartInMins:0};if(a.toUpperCase()==o.Z.UPCOMING.name){var s=new Date(i+" "+t+" "+r),c=(new Date(i+" "+n+" "+r),function(e){var t=new Date,n=(e.getTime()-t.getTime())/1e3,i=n/60,a=i/60,r=a/24;return n<=0?{status:o.Z.COMPLETED,bannerText:" "+o.Z.COMPLETED.name+" ",timeToStartInMins:0}:n>=1&&n<=30?{status:o.Z.UPCOMING,bannerText:"Starts in "+Math.round(n)+" sec ",timeToStartInMins:n/60}:i<60?{status:o.Z.UPCOMING,bannerText:"Starts in "+Math.round(i)+" min ",timeToStartInMins:i}:a<24?{status:o.Z.UPCOMING,bannerText:"Starts in "+Math.round(a)+" hr ",timeToStartInMins:60*a}:r<7?{status:o.Z.UPCOMING,bannerText:" "+["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][e.getDay()]+" ",timeToStartInMins:60*r*24}:{status:o.Z.UPCOMING,bannerText:"Upcoming",timeToStartInMins:2880}}(s));return{status:c.status,bannerText:c.bannerText,timeToStartInMins:c.timeToStartInMins}}return console.error("invalid status for event :: id : "+e.event_id+", status : "+e.status),{status:o.Z.DEFAULT,bannerText:"live event",timeToStartInMins:2880}}}},4998:function(e,t,n){n.d(t,{D:function(){return o}});const o=async function(e,t,n,o){var i=await fetch("https://"+window.location.hostname+"/cart.js",{cache:"reload"}).then((e=>e.json()));if("27358003275"==e||"63748341981"==e||"68237558034"==e)document.documentElement.dispatchEvent(new CustomEvent("cart:refresh",{bubbles:!0,detail:{cart:i,openMiniCart:!0}}));else if("19506115"==e)window.PXUTheme.jsAjaxCart.showDrawer(),window.PXUTheme.jsAjaxCart.updateView();else if("54465429691"==e)refreshCart(i),window.setTimeout((function(){$.fancybox.close(),$(".cart-button").click()}),500);else if("25427564"==e){(new theme.CartDrawer).open()}else"62602182872"==e||"57362710572"==e?(CartJS.getCart(),$(".block-cart").addClass("active")):document.documentElement.dispatchEvent(new CustomEvent("product:added",{bubbles:!0,detail:{}}));setTimeout(t,n)}},5160:function(e,t,n){n.d(t,{$L:function(){return s},JX:function(){return r},rp:function(){return c},wh:function(){return i},wz:function(){return a}});var o=n(2860);n(9543);function i(e){console.debug("updating user view count for event.");const t={event_id:e.event_id,increase_by:1};fetch(o.Gc+"/event/metrics/views",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)}).then((e=>(console.debug("updating user view count response : HTTP "+e.status),e.json()))).then((e=>{console.debug("updating user view count response : "+JSON.stringify(e))})).catch((e=>{console.error("error updating user view count user for event : ",e)}))}function a(e,t){console.debug("updating event-product click count for event {} and product {}.",e.event_id,t.product_id);const n={event_id:e.event_id,product_id:t.product_id,increase_by:1};fetch(o.Gc+"/event/metrics/clicks",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(n)}).then((e=>(console.debug("updating user event-product click count response : HTTP "+e.status),e.json()))).then((e=>{console.debug("updating user event-product click count response : "+JSON.stringify(e))})).catch((t=>{console.error("error updating user event-product click count for event {} : ",e.event_id,t)}))}function r(e,t,n){console.debug("updating event-product add to cart count for event {} and product {}.",e.event_id,t.product_id);const i={event_id:e.event_id,product_id:t.product_id,increase_by:n};fetch(o.Gc+"/event/metrics/add_to_cart",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(i)}).then((e=>(console.debug("updating user event-product add to cart count response : HTTP "+e.status),e.json()))).then((e=>{console.debug("updating user event-product add to cart count response : "+JSON.stringify(e))})).catch((t=>{console.error("error updating user event-product add to cart count for event {} : ",e.event_id,t)}))}function s(e,t){console.debug("updating event-product buy now count for event {} and product {}.",e.event_id,t.product_id);const n={event_id:e.event_id,product_id:t.product_id,increase_by:1};fetch(o.Gc+"/event/metrics/buy_now",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(n)}).then((e=>(console.debug("updating user event-product buy now count response : HTTP "+e.status),e.json()))).then((e=>{console.debug("updating user event-product buy now count response : "+JSON.stringify(e))})).catch((t=>{console.error("error updating user event-product buy now count for event {} : ",e.event_id,t)}))}async function c(){let{storeId:e="",eventId:t=0,productId:n="",variantId:i="",cartToken:a="",checkoutToken:r="",quantity:s=0,price:c="",actionType:d="",trackingId:u=""}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},l={event_id:t,product_id:n,cart_token:a,checkout_token:r,quantity:s,price:c,variant_id:i,action_type:d,tracking_id:u};console.debug("initiating ATC metadata event for eventId {}, productId {}, variantId {} ",t,n,i);const p=await fetch(o.Gc+"/cart-metadata/"+e,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(l)}).then((e=>(console.debug("initiating ATC metadata event for eventId {}, productId {}, variantId {} : HTTP "+e.status),e.json()))).catch((e=>{console.error("error initiating ATC metadata event for eventId {}, productId {}, variantId {} : ",t,n,i)}));return p}},4669:function(e,t,n){n.d(t,{Tc:function(){return u},ll:function(){return d}});var o=n(1824),i=n(9854);n(9543);const a="Whatmore Video Shopping",r="Video View",s={carousel:"Carousel",stories:"Stories",video_popup:"Video Popup"},c={homepage:"Home Page",product_page:"Product Page"};async function d(e){null!==(0,i.BH)(e)&&o.ZP.initialize((0,i.BH)(e),{useExistingGa:!0})}async function u(e,t,n){null!==(0,i.BH)(e)&&(o.ZP.event({category:a,action:r,label:c[t]+":"+s[n]}),console.debug("pushed view event to GA"))}}}]);