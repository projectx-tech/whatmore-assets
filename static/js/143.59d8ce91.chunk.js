"use strict";(self.webpackChunkwhatmorelive_react=self.webpackChunkwhatmorelive_react||[]).push([[143],{4284:function(e,t,n){n.r(t);var o=n(7313),i=n(9854),a=n(2860),r=n(7753),c=n(5160),s=(n(4844),n(6967)),d=n(5380),h=n(58),l=n(8984),u=(n(7247),n(1824),n(4669)),p=n(941),w=n(9302),f=n(2575),v=n(7300),m=n(6524),g=(n(4136),n(6417));const E=(0,f.Z)({key:"whatmore-css-ppv"}),S=o.lazy((()=>Promise.all([n.e(648),n.e(576),n.e(853),n.e(843),n.e(926),n.e(607),n.e(282),n.e(204)]).then(n.bind(n,2607))));function j(e){return e.split(/[?#]/)[0]}t.default=function(e){const[t,n]=(0,o.useState)(),[f,y]=(0,o.useState)(),[_]=(0,r.j1)("isInDesignMode"),[k]=(0,r.j1)("isDemoBrand"),[b]=(0,r.j1)("whatmoreEmbedAppUseVariant"),[x,I]=(0,o.useState)(-2),[C]=(0,r.j1)("whatmoreVariantId"),[M]=(0,r.j1)("whatmoreShopId");var[O]=(0,r.j1)("whatmoreProductId");const P=(0,r.MO)("isLandingSharedLink"),T=(0,r.MO)("whatmoreShareTemplateId"),V=((0,r.MO)("whatmoreShareStoryId"),(0,r.MO)("whatmoreShareEventId"));O=(0,i.iX)(M)?j(window.location.href):O;const[D,L]=(0,o.useState)((()=>"true"===b?C:O));var U=a.Gc+"/v2/brand/"+M+"/product-events";(0,o.useEffect)((()=>{(0,s.hb)()}),[]),(0,o.useEffect)((()=>{(0,u.ll)(M)}),[]),(0,o.useEffect)((()=>{null==t||0==t.length||f||!(0,l.KE)()||(0,r.MO)("whatmoreVideoPlayerPoolInitiated")||(0,h.b5)(h.UD)}),[t]),(0,o.useEffect)((()=>{I(-1),fetch(U.toString()+"?client_product_id="+D.toString()+"&status="+"upcoming".toString()+"&event_type=video").then((e=>e.json())).then((e=>e.events)).then((e=>(n(e),e))).then((e=>((0,i.yo)(M)&&function(e,t){setTimeout((async()=>{const n=e.reduce(((e,t)=>[...e,...t.products]),[]).filter((e=>e.client_product_id==t))[0];if(!n||n.product_link==j(window.location.href))return;const o={product_id:n.product_id,product_link:j(window.location.href)};fetch(a.Gc+"/product",{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(o)})}),500)}(e,D),e))).catch((e=>{y(e.message)}))}),[D]),(0,o.useEffect)((()=>{I(-2)}),[t]),(0,o.useEffect)((()=>{let e=history.pushState;history.pushState=function(){let t=e.apply(this,arguments);return window.dispatchEvent(new Event("pushstate")),window.dispatchEvent(new Event("locationchange")),t};let t=history.replaceState;history.replaceState=function(){let e=t.apply(this,arguments);return window.dispatchEvent(new Event("replacestate")),window.dispatchEvent(new Event("locationchange")),e},window.addEventListener("popstate",(()=>{window.dispatchEvent(new Event("locationchange"))})),window.addEventListener("locationchange",(function(){if("true"===b){const e=function(e){for(var t=window.location.search.substring(1).split("&"),n=0;n<t.length;n++){var o=t[n].split("=");if(o[0]==e)return o[1]}return!1}("variant");e&&""!==e&&L(e)}}))}),[]),(0,o.useEffect)((()=>{null==t||0==t.length||f||P&&"template-embed"==(0,m.zv)(T)&&null!=V&&t.forEach(((e,t)=>{V==e.event_id&&A(e,!0,t)}))}),[t]);const A=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if((0,l.KE)()&&!t&&(0,h.QV)(),(0,v.B6)(e)||(0,v.WJ)(e))return _||k||(async()=>{(0,c.wh)(e),(0,u.Tc)(M,a.h7,a.dU),(0,s.H4)(e.event_id,e.products,"product_page","video_popup")})(),void I(n)};function B(){return(0,g.jsx)(g.Fragment,{})}return null==t||0==t.length||f?(0,g.jsx)("div",{}):(0,g.jsx)(w.C,{value:E,children:"no-product"===D||-1===x||0===t.length?(0,g.jsx)(B,{}):-2===x&&t.length>0?(0,g.jsx)("div",{children:(0,g.jsx)(d.Z,{event:t[0],inVideoClick:A,closeClick:e=>{e.stopPropagation(),I(-1)}})}):(0,g.jsx)("div",{children:(0,g.jsx)(o.Suspense,{children:(0,g.jsx)(S,{events:t,index:x,onBack:function(){(0,i.n2)(M)&&(0,r.MO)("whatmoreAddedToCart")&&(0,p.D)(M,(()=>{}),100,window.location.hostname),I(-2)},template:"template-product-page"})})})})}}}]);